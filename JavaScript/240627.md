# fetch(POST, DELETE), ì‹¤ìŠµ(ìœ ì € ë¦¬ìŠ¤íŠ¸ ì¹´ë“œ), localStorage

- [1. fetch](#1-fetch)(#1-3-xhr-íŒŒì¼ì„-ì½œë°±ì´-ì•„ë‹Œ-í”„ë¡œë¯¸ìŠ¤-ë°©ì‹ìœ¼ë¡œ-ë§Œë“¤ê¸°)
- [2. asyncì™€ await](#2-asyncì™€-await)
- [3. fetch](#3-fetch)
- [ğŸ‘€Â ì ê¹ ì–¸ê¸‰í•œ ì´ê²ƒì €ê²ƒ](#-ì ê¹-ì–¸ê¸‰í•œ-ì´ê²ƒì €ê²ƒ)

## 1. fetch

- POST í†µì‹ , DELETE í†µì‹ 

```jsx
const ENDPOINT = 'https://jsonplaceholder.typicode.com/users/'

// fetch  => promise
const tiger = async (method,url,body) => {

  const response = await fetch(url,{
    method:method,
    body:JSON.stringify(body),
    headers:{
      'Content-Type':'application/json',
      'Access-Control-Allow-Origin':'*'
    }
  });

  if(response.ok){
    response.data = await response.json();
  }

  return response;
}

// const result = await tiger('POST',ENDPOINT,{name:'tiger'});
const result = await tiger('DELETE',`${ENDPOINT}/3`);

console.log(result);
```

<br><br><br>

## 2. renderUserList ë§Œë“¤ê¸°

```jsx
import {getNode, tiger, insertLast} from "./lib/index.js"

const ENDPOINT = 'https://jsonplaceholder.typicode.com/users'

const userCardInner = getNode('.user-card-inner')

async function renderUserList() {
  const response = await tiger.get(ENDPOINT);

  const data = response.data;

  data.forEach((user, index) => {

    const template = /* html */`
      <article class="user-card" data-index="user-${index}">
          <h3 class="user-name">${user.name}</h3>
          <div class="user-resouce-info">
            <div>
              <a class="user-email" href="mailto:${user.email}">${user.email}</a>
            </div>
            <div>
              <a class="user-website" href="${user.website}" target="_blank" rel="noopener noreferer">${user.website}</a>
            </div>
          </div>
          <button class="delete">ì‚­ì œ</button>
        </article>
    `
    
    insertLast(userCardInner,template)
  })

  
}

renderUserList()
```

í•¨ìˆ˜ê°€ ë„ˆë¬´ ë§ì€ ì¼ì„ í•¨.. ë¶„ë¦¬ì‹œì¼œë³´ì

> ğŸ’¡ ***ê´€ì‹¬ì‚¬ì˜ ë¶„ë¦¬*** ğŸ’¡  
> í•¨ìˆ˜ ë‹¹ í•˜ë‚˜ì˜ ì¼ë§Œ ì²˜ë¦¬í•˜ê¸°!

```jsx
import { insertLast } from './insert.js'

// ìƒì„± í•¨ìˆ˜
function createUserCard({
  id,
  name = 'tiger',
  email = 'tiger@naver.com',
  website = 'tiger@tiger.com',
}){

  return `
    <article class="user-card" data-index="user-${id}">
        <h3 class="user-name">${name}</h3>
        <div class="user-resource-info">
          <div>
            <a class="user-email" href="mailto:${email}">${email}</a>
          </div>
          <div>
            <a class="user-website" href="${website}" target="_blank" rel="noopener noreferer">${website}</a>
          </div>
        </div>
        <button class="delete">ì‚­ì œ</button>
      </article>
  `
}

// ë Œë”ë§ í•¨ìˆ˜
export function renderUserCard(target,data){
  
  insertLast(target, createUserCard(data));

}
```

```jsx
import { 
  tiger, getNode, renderUserCard, changeColor
 } from './lib/index.js';

const userCardInner = getNode('.user-card-inner')

async function renderUserList() {
	try {
		const response = await tiger.get(ENDPOINT);
	  const data = response.data;

	  data.forEach(user => renderUserCard(userCardInner, user))
	}
	
	catch {
		console.error('ì—ëŸ¬ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.')
	}
}

renderUserList()
```

ğŸ”· ì—ëŸ¬ ì²˜ë¦¬í•  ë•Œ ì‚¬ìš© (íšŒì‚¬ì—ì„œ ê¶Œì¥í•˜ëŠ” ê±¸ë¡œ ì‚¬ìš©!)

- `try .. catch`
- `promise .. then`
- `async await .. then`

<br>

ğŸ”· ì¸í„°ë„·ì´ ëŠë¦´ ê²½ìš°, ë¡œë”© í™”ë©´ì´ í•„ìš”í•´ìš”!  
ì• ë‹ˆë©”ì´ì…˜ ì¢…ë¥˜
- DOM
- WebGL â‡’ canvas
- SVG : ì¼ë°˜ì ìœ¼ë¡œ DOMì´ í•˜ì§€ ëª»í•˜ëŠ” ê²ƒë“¤ì„ ìˆ˜í–‰í•´ì¤Œ.

<br>

ê·¸ë˜ì„œ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤.  
1ï¸âƒ£ ë¡œë”© ìŠ¤í”¼ë„ˆ ìƒì„± í•¨ìˆ˜

```jsx
function createSpinner(size = 100, loadingMessage = 'ğŸ˜’ ìœ ì € ì •ë³´ ê°€ì ¸ì˜¤ëŠ” ì¤‘..') {
  return /* html */ `
    <figure class="loadingSpinner">
        <svg> ì´ëŸ¬ì¿µì €ëŸ¬ì¿µ </svg>
				<figcaption>${loadingMessage}</figcaption>
      </figure>
  `
}
```

2ï¸âƒ£ ë¡œë”© ìŠ¤í”¼ë„ˆ ë Œë”ë§ í•¨ìˆ˜

```jsx
export function renderSpinner(target) {
  insertLast(target, createSpinner())
}
```

3ï¸âƒ£ ë¡œë”© ìŠ¤í”¼ë„ˆ ì• ë‹ˆë©”ì´ì…˜ìœ¼ë¡œ ì œê±°

```jsx
const userCardInner = getNode('.user-card-inner');

async function renderUserList(){

  // ë¡œë”© ìŠ¤í”¼ë„ˆ ë Œë”ë§
  renderSpinner(userCardInner) 
  // await delayP(2000);  

  try{
    gsap.to('.loadingSpinner',{
      opacity:0,
      onComplete(){
        this._targets[0].remove()
      }
    })
    
    const response = await tiger.get(ENDPOINT);
    const data = response.data;
  
    data.forEach(user => renderUserCard(userCardInner,user))
 
    changeColor('.user-card');  
    gsap.from('.user-card',{
      x:-100,
      opacity:0,
      stagger: {
        amount: 1,
        from:'start'
      }
    })
  }
  catch{
    console.error('ì—ëŸ¬ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤!');
    renderEmptyCard(userCardInner)
  }
}

renderUserList()
```

ğŸ gsapì„ ì‚¬ìš©í•˜ì§€ ì•Šê³  **ìˆœìˆ˜ ìë°”ìŠ¤í¬ë¦½íŠ¸ë¡œ ì´ë²¤íŠ¸ë¥¼ ì²˜ë¦¬**í•˜ëŠ” ë°©ë²•ë„ ìˆìŠµë‹ˆë‹¤!

ì´ ê²½ìš°, classì™€ cssë¥¼ ì ì ˆíˆ ì¡°í•©í•˜ì—¬ `classList.add()` / `classList.remove()`ë¥¼ í•´ì£¼ë©´ ë©ë‹ˆë‹¤.

4ï¸âƒ£ í†µì‹ ì„ ì˜ëª»í–ˆì„ ë•Œ `empty-user-card` ìƒì„±

```jsx
// empty-card ìƒì„±
function createEmptyCard(size = 200, errorMessage = 'ğŸ˜µ ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.') {
  const template = /* html */ `
    <figure class="empty-user-card">
      <svg> ëŒ€ì¶© svg </svg>
      <figcaption>ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</figcaption>
    </figure>
  `;

  return template;
}

// empty-card ë Œë”ë§
export function renderEmptyCard(target) {
  insertLast(target, createEmptyCard())
}
```

<br><br><br>

## 3. localStorage

ì›¹ì—ëŠ” ë„ˆë¬´ ë§ì€ ìë£Œê°€ ìˆë‹¤ë‹ˆ, ë§¤ë²ˆ ë¹„ë™ê¸° í†µì‹ ìœ¼ë¡œ ìš”ì²­ ë° ì‘ë‹µì€ ë¹„íš¨ìœ¨ì ì¼ ìˆ˜ ìˆìŒ. ê·¸ë˜ì„œ í´ë¼ì´ì–¸íŠ¸ ì¸¡ì—ì„œ ê´€ë¦¬í•  ìˆ˜ ìˆë‹¤. â¡ï¸ ì›¹ ë¸Œë¼ìš°ì €

ë” ë§ì€ ë‚´ìš©ì„ ì €ì¥í•˜ê³  ì‹¶ë‹¤ë©´ IndexedDBë¥¼ ì‚¬ìš©í•˜ë©´ ëœë‹¤.

> ğŸ” **IndexedDB**ë€?  
ì›¹ ë¸Œë¼ìš°ì € ë‚´ë¶€ì—ì„œ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ìƒì„±í•˜ê³ , ë°ì´í„°ë¥¼ ì €ì¥/ê²€ìƒ‰í•˜ëŠ”ë° ì‚¬ìš©ë˜ëŠ” APIì´ë‹¤. í´ë¼ì´ì–¸íŠ¸ ì¸¡ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ëŒ€ìš©ëŸ‰ ë°ì´í„°ë¥¼ ì €ì¥í•˜ê³  ê²€ìƒ‰í•  ë•Œ ìœ ìš©í•˜ë‹¤.
> 

`localStorage` :  ì°½ ë‹«ê³  ë‹¤ì‹œ ë“¤ì–´ê°€ë„ ì €ì¥ë˜ì–´ ìˆìŒ

 ë§ì€ ì •ë³´ì˜ ê°’ì„ ë³´ë‚¼ë• ë¬¸ìë¡œ ë³´ë‚´ì•¼ í•˜ë¯€ë¡œ

- ê°’ì„ ì„¤ì •í•  ë•Œ setItem / JSON.stringify
- ê°’ì„ ê°€ì ¸ì˜¬ ë•Œ getItem / JSON.parse

ğŸ¤” ë§¤ë²ˆ `JSON.stringify`ì™€ `JSON.parse`ì„ ì“°ê¸° ê·€ì°®ë‹¤.

ê·¸ëŸ¼ í•¨ìˆ˜ë¡œ ë§Œë“¤ì

- setStorage

```jsx
export function setStorage(key, value) {

  return new Promise((resolve, reject) => {
    if(isString(key)) {
      storage.setItem(key, JSON.stringify(value));
      resolve()
    } else {
      reject()
    }
  })
}
```

- getStorage

```jsx
export function getStorage(key) {

  return new Promise((resolve, reject) => {
    if(isString(key)) {
      resolve(JSON.parse(storage.getItem(key)));
    } else {
      reject();
    }
  })
}
```

- deleteStorage

```jsx
export function deleteStorage(key) {
  return new Promise((resolve, reject) => {
    !key ? storage.clear() : storage.removeItem(key);
    resolve()
  })
}
```

<br><br><br>

## ğŸ‘€Â ì ê¹ ì–¸ê¸‰í•œ ì´ê²ƒì €ê²ƒ

**ğŸ¤” SPAê°€ ë­ì˜€ì§€**

Single Page Application

- barba.jsë¼ëŠ” í”ŒëŸ¬ê·¸ì¸ì´ ìˆëŠ”ë° SPA ë§Œë“¤ê¸° í¸í•˜ë‹¤ê³  í•¨

<br>

ğŸ˜µ **SPAì˜ ì¹˜ëª…ì ì¸ ë‹¨ì **

- SEOê°€ ì¡íˆì§€ ì•ŠëŠ”ë‹¤.
- ì‹¤ì œ ë‚´ìš©ì´ ì¡´ì¬í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— ê²€ìƒ‰ì–´ ìˆ˜ì§‘ì´ ì•ˆë¨
- ì´ê±¸ í•´ê²°í•˜ëŠ” ë°©ì•ˆì´ ìˆëŠ”ë° ì•¼ë¬´ìŒ¤í•œí…Œ ë¬¼ì–´ë³´ì‹œê¸¸.. (ë¼ê³  ë²”ìŒ¤ì´ ë§ì”€í•˜ì…¨ìŠµë‹ˆë‹¤.)

<br>

ğŸ˜Â **ê°€ì§œ ì„œë²„ ë§Œë“¤ê¸°** ( ë‚´ ì»´í“¨í„°ë¥¼ ì„ì‹œ ì €ì¥ì†Œ(=ì„œë²„)ë¡œ ë§Œë“¦)  
1ï¸âƒ£ `npm i -D json-server@0.17.4`  
2ï¸âƒ£ ğŸ“‚ server > data > data.json (í´ë” ë‚´ íŒŒì¼ ìƒì„± í›„ data ë¶™ì—¬ë„£ê¸°)  
3ï¸âƒ£ `npx json-server server/data/data.json`  (ì„œë²„ êµ¬ë™)  
â‡’ lacalhostë¥¼ ì„œë²„ë¡œ ë§Œë“¦ (ì´ì œ jsonplaceholder ì£¼ì†Œì™€ í†µì‹ ì„ í•˜ëŠ” ê²Œ ì•„ë‹ˆë¼, ë‚´ ì»´í“¨í„°ì™€ í†µì‹ ì„ í•  ê±°ì„ ã…)  
4ï¸âƒ£ `s` + `enter` ëˆ„ë¥´ë©´ ìŠ¤ëƒ…ìƒ· ë§Œë“¤ì–´ì§ (ë°±ì—… íŒŒì¼ ìƒì„±)  
5ï¸âƒ£ ì„œë²„ êµ¬ë™í•˜ê¸° í¸í•˜ê²Œ package.json > scripts ì¶”ê°€

`"serve": "json-server server/data/data.jsonâ€`

```jsx
"scripts": {
    "dev": "live-server client --host=localhost --port=5500 --no-browser",
    "serve": "json-server server/data/data.json",
    "all": "run-p dev serve"
 },
```

6ï¸âƒ£ `npm i npm run all -D` : ê·€ì°®ìœ¼ë‹ˆê¹Œ í•œ ë²ˆì—! (ë³‘ë ¬ ë°©ì‹ìœ¼ë¡œ ë‘ ê°œë¥¼ ê°™ì´ ì‹¤í–‰)  
ì´ì œ `npm run all`ë¡œ êµ¬ë™í•  ìˆ˜ ìˆìŒ!
